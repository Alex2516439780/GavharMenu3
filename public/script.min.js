let currentLanguage="ru",currentCategory=null,currentSubcategory=null,selectedCategory=null,cart=[],dishes=[],allDishes=[],categories=[],currentSlide=0;const cardsPerView=4;function handleImageLoad(e){e.style.filter="brightness(1.05)",e.style.opacity="1",e.classList.remove("loading")}function handleImageError(e){e.src="/ELEMENTS/image 2.png",e.style.filter="brightness(1.05)",e.style.opacity="1",e.classList.remove("loading")}function debounce(e,t){let a;return function(...n){clearTimeout(a),a=setTimeout(()=>e.apply(this,n),t)}}function hydrateLazyElement(e,t=!1){if(e)if("PICTURE"===e.tagName){const t=e.querySelectorAll("source[data-srcset]"),a=e.querySelector("img[data-src]");t.forEach(e=>{e.setAttribute("srcset",e.getAttribute("data-srcset")),e.removeAttribute("data-srcset")}),a&&(a.src=a.dataset.src,a.removeAttribute("data-src")),e.classList.remove("lazy-picture")}else"IMG"===e.tagName&&e.dataset&&e.dataset.src&&(e.src=e.dataset.src,e.removeAttribute("data-src"))}!function(){try{const e=/localhost|127\.0\.0\.1/.test(location.hostname),t=new URLSearchParams(location.search).has("debug");e||t||["log","info","debug"].forEach(e=>{try{console[e]=function(){}}catch(e){}})}catch(e){}}();let __imageObserver=null;function getImageObserver(){return"IntersectionObserver"in window?__imageObserver||(__imageObserver=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const a=e.target;a.dataset.src&&(a.src=a.dataset.src,a.removeAttribute("data-src"),a.classList.add("loading"),a.onload=function(){this.classList.remove("loading"),this.style.opacity="1"}),t.unobserve(e.target)}})},{rootMargin:"200px 0px",threshold:.1}),__imageObserver):null}function setupLazyImages(e=document){const t=e.querySelectorAll("img[data-src]");if(0===t.length)return;const a=getImageObserver();a?t.forEach(e=>a.observe(e)):t.forEach(e=>{e.dataset.src&&(e.src=e.dataset.src,e.removeAttribute("data-src"))})}const API_BASE="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"/api":`${window.location.protocol}//${window.location.hostname}/api`;function getImageCacheBuster(){return localStorage.getItem("gavhar_last_known_update")||localStorage.getItem("gavhar_data_updated")||String(Date.now())}function getOptimalImageQuality(){if("connection"in navigator){const e=navigator.connection;if("slow-2g"===e.effectiveType||"2g"===e.effectiveType)return{quality:60,format:"webp"};if("3g"===e.effectiveType)return{quality:75,format:"webp"};if("4g"===e.effectiveType)return{quality:85,format:"webp"}}const e=performance.now();return e>3e3?{quality:60,format:"webp"}:e>1500?{quality:75,format:"webp"}:{quality:85,format:"webp"}}function getSupportedImageFormats(){const e={webp:!1,avif:!1,jpeg:!0,png:!0},t=document.createElement("canvas");if(t.width=1,t.height=1,e.webp=0===t.toDataURL("image/webp").indexOf("data:image/webp"),"undefined"!=typeof Image){const t=new Image;t.onload=()=>e.avif=!0,t.onerror=()=>e.avif=!1,t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgABogQEAwgMg8f8D///8WfhwB8+ErK42A="}return e}function prewarmApiCache(e){try{"serviceWorker"in navigator&&navigator.serviceWorker.controller&&Array.isArray(e)&&e.length&&navigator.serviceWorker.controller.postMessage({type:"prewarm",urls:e})}catch(e){}}function prewarmQueue(e,t=1200,a=5){try{const n=(e||[]).slice(0,a);if(0===n.length)return;let o=0;const i=window.requestIdleCallback||function(e){return setTimeout(e,t)},s=()=>{if(o>=n.length)return;const e=n[o++];try{fetch(e).catch(()=>{})}catch(e){}prewarmApiCache([e]),i(s,{timeout:t})};i(s,{timeout:t})}catch(e){}}function preloadCriticalImages(e){if(!Array.isArray(e)||0===e.length)return;const t=getOptimalImageQuality(),a=getSupportedImageFormats();e.slice(0,6).forEach((e,n)=>{if(!e.image)return;if(e.image.includes("images.unsplash.com")){const o=a.avif?"avif":a.webp?"webp":"auto",i=t.quality,s=`${e.image}${e.image.includes("?")?"&":"?"}w=400&h=250&fit=crop&fm=${o}&auto=format&q=${i}`,r=document.createElement("link");r.rel="preload",r.as="image",r.href=s,r.fetchpriority=n<3?"high":"low",document.head.appendChild(r),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r)},15e3)}})}function adaptiveImageLoading(){if(getOptimalImageQuality().quality<=60){const e=getImageObserver();e&&(e.disconnect(),__imageObserver=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&setTimeout(()=>{const a=e.target;a.dataset.src&&(a.src=a.dataset.src,a.removeAttribute("data-src")),t.unobserve(e.target)},200)})},{rootMargin:"50px 0px",threshold:.1}))}}const translations={ru:{salads:"САЛАТЫ",drinks:"НАПИТКИ",desserts:"ДЕСЕРТЫ",steak:"СТЕЙК",shashlik:"ШАШЛЫКИ",cart:"Корзина",total:"Итого:",checkout:"Очистить",composition:"Состав:",weight:"Вес:",cooking_time:"Время приготовления:",search_placeholder:"Найти блюда",all:"Все",cart_empty:"Корзина пуста",order_total:"Сумма заказа:",service_charge:"Обслуживание",sum:"сум"},uz:{salads:"SALATLAR",drinks:"ICHIMLIKLAR",desserts:"TATLILAR",steak:"STEAK",shashlik:"SHASHLIKLAR",cart:"Savat",total:"Jami:",checkout:"Tozalash",composition:"Tarkibi:",weight:"Og'irligi:",cooking_time:"Tayyorlash vaqti:",search_placeholder:"Taom qidirish",all:"Hammasi",cart_empty:"Savat bo'sh",order_total:"Buyurtma summasi:",service_charge:"Xizmat",sum:"so'm"},en:{salads:"SALADS",drinks:"DRINKS",desserts:"DESSERTS",steak:"STEAK",shashlik:"SHASHLIK",cart:"Cart",total:"Total:",checkout:"Clear",composition:"Composition:",weight:"Weight:",cooking_time:"Cooking time:",search_placeholder:"Find dishes",all:"All",cart_empty:"Cart is empty",order_total:"Order total:",service_charge:"Service",sum:"sum"}},sampleCategories=[{id:1,key:"drinks",name:{ru:"Напитки",uz:"Ichimliklar",en:"Drinks"},isAlcoholic:!1,subcategories:[{id:11,key:"hot_drinks",name:{ru:"Горячие напитки",uz:"Issiq ichimliklar",en:"Hot drinks"}},{id:12,key:"cold_drinks",name:{ru:"Холодные напитки",uz:"Sovuq ichimliklar",en:"Cold drinks"}},{id:13,key:"juices",name:{ru:"Соки",uz:"Sharbatlar",en:"Juices"}}]},{id:2,key:"salads",name:{ru:"Салаты",uz:"Salatlar",en:"Salads"},isAlcoholic:!1,subcategories:[{id:21,key:"vegetable_salads",name:{ru:"Овощные салаты",uz:"Sabzavot salatlari",en:"Vegetable salads"}},{id:22,key:"meat_salads",name:{ru:"Салаты с мясом",uz:"Goshtli salatlar",en:"Meat salads"}}]},{id:3,key:"desserts",name:{ru:"Десерты",uz:"Shirinliklar",en:"Desserts"},isAlcoholic:!1,subcategories:[{id:31,key:"cakes",name:{ru:"Торты",uz:"Tortlar",en:"Cakes"}},{id:32,key:"ice_cream",name:{ru:"Мороженое",uz:"Muzqaymoq",en:"Ice cream"}}]},{id:4,key:"steak",name:{ru:"Стейк",uz:"Steak",en:"Steak"},isAlcoholic:!1,subcategories:[{id:41,key:"beef_steak",name:{ru:"Говяжий стейк",uz:"Mol goshti steaki",en:"Beef steak"}},{id:42,key:"chicken_steak",name:{ru:"Куриный стейк",uz:"Tovuq steaki",en:"Chicken steak"}}]},{id:5,key:"shashlik",name:{ru:"Шашлыки",uz:"Shashliklar",en:"Shashlik"},isAlcoholic:!1,subcategories:[{id:51,key:"lamb_shashlik",name:{ru:"Шашлык из баранины",uz:"Qoy goshti shashligi",en:"Lamb shashlik"}},{id:52,key:"chicken_shashlik",name:{ru:"Шашлык из курицы",uz:"Tovuq shashligi",en:"Chicken shashlik"}}]},{id:6,key:"dishes",name:{ru:"Блюда",uz:"Taomlar",en:"Dishes"},isAlcoholic:!1,subcategories:[{id:61,key:"soups",name:{ru:"Супы",uz:"Sho'rvalar",en:"Soups"}},{id:62,key:"side_dishes",name:{ru:"Гарниры",uz:"Garnir",en:"Side dishes"}},{id:63,key:"main_dishes",name:{ru:"Основные блюда",uz:"Asosiy taomlar",en:"Main dishes"}}]},{id:7,key:"alcohol",name:{ru:"Алкоголь",uz:"Alkogol",en:"Alcohol"},isAlcoholic:!0,subcategories:[{id:71,key:"wine",name:{ru:"Вино",uz:"Sharob",en:"Wine"}},{id:72,key:"vodka",name:{ru:"Водка",uz:"Aroq",en:"Vodka"}},{id:73,key:"beer",name:{ru:"Пиво",uz:"Pivo",en:"Beer"}}]}],sampleDishes=[{id:1,name:{ru:"Салат Цезарь",uz:"Sezar salati",en:"Caesar Salad"},category:"salads",subcategory:"vegetable_salads",price:28e3,order:1,image:"https://images.unsplash.com/photo-1546793665-c74683f339c1?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1546793665-c74683f339c1?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=400&h=300&fit=crop"],composition:{ru:"Салат романо, куриная грудка, пармезан, сухарики, соус цезарь",uz:"Romaine salat, tovuq ko'kragi, parmezan, kruton, sezar sousi",en:"Romaine lettuce, chicken breast, parmesan, croutons, caesar dressing"},weight:"250г",cookingTime:"15 мин",inStock:!0,isAlcoholic:!1},{id:2,name:{ru:"Салат ташкент",uz:"Toshkent salati",en:"Tashkent Salad"},category:"salads",subcategory:"vegetable_salads",price:28e3,order:2,image:"https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=400&h=300&fit=crop"],composition:{ru:"Свежие овощи, зелень, оливковое масло",uz:"Yangi sabzavotlar, ko'katlar, zaytun moyi",en:"Fresh vegetables, herbs, olive oil"},weight:"200г",cookingTime:"10 мин",inStock:!0,isAlcoholic:!1},{id:3,name:{ru:"Салат с грибами",uz:"Qo'ziqorinli salat",en:"Mushroom Salad"},category:"salads",subcategory:"vegetable_salads",price:28e3,order:3,image:"https://images.unsplash.com/photo-1540420773420-3366772f4999?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1540420773420-3366772f4999?w=400&h=300&fit=crop"],composition:{ru:"Шампиньоны, лук, майонез, зелень",uz:"Champignon qo'ziqorinlari, piyoz, mayonez, ko'katlar",en:"Mushrooms, onion, mayonnaise, herbs"},weight:"220г",cookingTime:"12 мин",inStock:!0,isAlcoholic:!1},{id:4,name:{ru:"Салат аччик чичук",uz:"Achchiq chichuk salat",en:"Spicy Chichuk Salad"},category:"salads",subcategory:"vegetable_salads",price:28e3,order:4,image:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop"],composition:{ru:"Помидоры, огурцы, лук, перец, специи",uz:"Pomidor, bodring, piyoz, qalampir, ziravorlar",en:"Tomatoes, cucumbers, onion, pepper, spices"},weight:"180г",cookingTime:"8 мин",inStock:!0,isAlcoholic:!1},{id:5,name:{ru:"Салат с мясом",uz:"Go'shtli salat",en:"Meat Salad"},category:"salads",subcategory:"meat_salads",price:28e3,order:5,image:"https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=400&h=300&fit=crop"],composition:{ru:"Говядина, овощи, зелень, соус",uz:"Mol go'shti, sabzavotlar, ko'katlar, sous",en:"Beef, vegetables, herbs, sauce"},weight:"300г",cookingTime:"20 мин",inStock:!0,isAlcoholic:!1},{id:6,name:{ru:"Салат баклажан",uz:"Baqlajon salati",en:"Eggplant Salad"},category:"salads",subcategory:"vegetable_salads",price:28e3,order:6,image:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop"],composition:{ru:"Баклажаны, помидоры, лук, чеснок",uz:"Baqlajon, pomidor, piyoz, sarimsoq",en:"Eggplant, tomatoes, onion, garlic"},weight:"200г",cookingTime:"25 мин",inStock:!0,isAlcoholic:!1},{id:7,name:{ru:"Салат со свеклой",uz:"Lobichali salat",en:"Beetroot Salad"},category:"salads",subcategory:"vegetable_salads",price:28e3,order:7,image:"https://images.unsplash.com/photo-1546793665-c74683f339c1?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1546793665-c74683f339c1?w=400&h=300&fit=crop"],composition:{ru:"Свекла, морковь, чеснок, майонез",uz:"Lobich, sabzi, sarimsoq, mayonez",en:"Beetroot, carrots, garlic, mayonnaise"},weight:"190г",cookingTime:"30 мин",inStock:!0,isAlcoholic:!1},{id:8,name:{ru:"Салат говурма",uz:"Govurma salat",en:"Govurma Salad"},category:"salads",subcategory:"meat_salads",price:28e3,order:8,image:"https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=400&h=300&fit=crop"],composition:{ru:"Жареное мясо, лук, специи",uz:"Qovurilgan go'sht, piyoz, ziravorlar",en:"Fried meat, onion, spices"},weight:"250г",cookingTime:"35 мин",inStock:!0,isAlcoholic:!1},{id:101,name:{ru:"Красное вино",uz:"Qizil sharob",en:"Red Wine"},category:"alcohol",subcategory:"wine",price:45e3,order:1,image:"https://images.unsplash.com/photo-1553361371-9b22f78e8b1d?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1553361371-9b22f78e8b1d?w=400&h=300&fit=crop"],composition:{ru:"Натуральное красное вино",uz:"Tabiiy qizil sharob",en:"Natural red wine"},weight:"750мл",cookingTime:"0 мин",inStock:!0,isAlcoholic:!0},{id:102,name:{ru:"Пиво светлое",uz:"Och pivo",en:"Light Beer"},category:"alcohol",subcategory:"beer",price:15e3,order:2,image:"https://images.unsplash.com/photo-1608270586620-248524c67de9?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1608270586620-248524c67de9?w=400&h=300&fit=crop"],composition:{ru:"Светлое пиво премиум класса",uz:"Premium sinf och pivo",en:"Premium light beer"},weight:"500мл",cookingTime:"0 мин",inStock:!0,isAlcoholic:!0},{id:201,name:{ru:"Кофе американо",uz:"Americano kofe",en:"Americano coffee"},category:"drinks",subcategory:"hot_drinks",price:15e3,order:1,image:"https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1509042239860-f550ce710b93?w=400&h=300&fit=crop"],composition:{ru:"Эспрессо, горячая вода",uz:"Espresso, issiq suv",en:"Espresso, hot water"},weight:"200мл",cookingTime:"3 мин",inStock:!0,isAlcoholic:!1},{id:202,name:{ru:"Свежевыжатый апельсиновый сок",uz:"Taza apelsin sharbati",en:"Fresh orange juice"},category:"drinks",subcategory:"juices",price:12e3,order:2,image:"https://images.unsplash.com/photo-1621506289937-a8e4df240d0b?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1621506289937-a8e4df240d0b?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop"],composition:{ru:"Свежие апельсины",uz:"Taza apelsinlar",en:"Fresh oranges"},weight:"250мл",cookingTime:"5 мин",inStock:!0,isAlcoholic:!1},{id:203,name:{ru:"Салат с курицей и авокадо",uz:"Tovuq va avokado salati",en:"Chicken and avocado salad"},category:"salads",subcategory:"meat_salads",price:32e3,order:2,image:"https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1546793665-c74683f339c1?w=400&h=300&fit=crop"],composition:{ru:"Куриная грудка, авокадо, помидоры, руккола, оливковое масло",uz:"Tovuq ko'kragi, avokado, pomidor, rukola, zaytun moyi",en:"Chicken breast, avocado, tomatoes, arugula, olive oil"},weight:"300г",cookingTime:"20 мин",inStock:!0,isAlcoholic:!1},{id:204,name:{ru:"Тирамису",uz:"Tiramisu",en:"Tiramisu"},category:"desserts",subcategory:"cakes",price:25e3,order:1,image:"https://images.unsplash.com/photo-1571877227200-a0d98ea607e9?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1571877227200-a0d98ea607e9?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=400&h=300&fit=crop"],composition:{ru:"Маскарпоне, савоярди, кофе, какао, яйца, сахар",uz:"Mascarpone, savoyardi, kofe, kakao, tuxum, shakar",en:"Mascarpone, savoiardi, coffee, cocoa, eggs, sugar"},weight:"150г",cookingTime:"0 мин",inStock:!0,isAlcoholic:!1},{id:205,name:{ru:"Стейк из говядины",uz:"Mol go'shtidan steak",en:"Beef steak"},category:"steak",subcategory:"beef_steak",price:85e3,order:1,image:"https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1529692236671-f1f6f9683df8?w=400&h=300&fit=crop"],composition:{ru:"Говяжья вырезка, соль, перец, розмарин, чеснок",uz:"Mol go'sht qismi, tuz, qalampir, rozmarin, sarimsoq",en:"Beef tenderloin, salt, pepper, rosemary, garlic"},weight:"300г",cookingTime:"15 мин",inStock:!0,isAlcoholic:!1},{id:206,name:{ru:"Шашлык из баранины",uz:"Qo'zi go'shtidan shashlik",en:"Lamb shashlik"},category:"shashlik",subcategory:"lamb_shashlik",price:65e3,order:1,image:"https://images.unsplash.com/photo-1529692236671-f1f6f9683df8?w=400&h=300&fit=crop",images:["https://images.unsplash.com/photo-1529692236671-f1f6f9683df8?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1546833999-b9f581a1996d?w=400&h=300&fit=crop"],composition:{ru:"Баранина, лук, специи, зелень",uz:"Qo'zi go'shti, piyoz, ziravorlar, ko'katlar",en:"Lamb meat, onions, spices, herbs"},weight:"400г",cookingTime:"25 мин",inStock:!0,isAlcoholic:!1}];async function initializeApp(){const e=document.createElement("style");e.textContent="\n        *, *::before, *::after { outline: none !important; }\n        *:focus, *:active, *:focus-visible, *:focus-within {\n            outline: none !important;\n            outline-width: 0 !important;\n            outline-style: none !important;\n            outline-color: transparent !important;\n            box-shadow: none !important;\n        }\n        button, button:focus, button:active, button:focus-visible, button:focus-within {\n            outline: none !important;\n            outline-width: 0 !important;\n            outline-style: none !important;\n            outline-color: transparent !important;\n            box-shadow: none !important;\n        }\n\n        /* Mobile and tablet specific */\n        @media (max-width: 1024px) {\n            *, *::before, *::after {\n                outline: none !important;\n                -webkit-tap-highlight-color: transparent !important;\n                -webkit-touch-callout: none !important;\n                -webkit-user-select: none !important;\n                -moz-user-select: none !important;\n                -ms-user-select: none !important;\n                user-select: none !important;\n            }\n\n            *:focus, *:active, *:focus-visible, *:focus-within {\n                outline: none !important;\n                outline-width: 0 !important;\n                outline-style: none !important;\n                outline-color: transparent !important;\n                box-shadow: none !important;\n                -webkit-tap-highlight-color: transparent !important;\n            }\n\n            button, button:focus, button:active, button:focus-visible, button:focus-within {\n                outline: none !important;\n                outline-width: 0 !important;\n                outline-style: none !important;\n                outline-color: transparent !important;\n                box-shadow: none !important;\n                -webkit-tap-highlight-color: transparent !important;\n                -webkit-touch-callout: none !important;\n                -webkit-user-select: none !important;\n                -moz-user-select: none !important;\n                -ms-user-select: none !important;\n                user-select: none !important;\n            }\n        }\n    ",document.head.appendChild(e),window.isGlobalSearch=!1,window.searchQuery=null,window.originalDishes=null,void 0!==allDishes&&(allDishes=[]),void 0!==dishes&&(dishes=[]);const t=localStorage.getItem("gavhar_data_updated");t&&localStorage.setItem("gavhar_last_known_update",t);const a=fetch(`${API_BASE}/categories?restaurant=${isRestaurantMode()}`,{cache:"no-cache"}).then(e=>e.ok?e.json():null).catch(()=>null);await loadData();try{const e=await a;e&&Array.isArray(e.data)&&e.data.length&&(!categories||0===categories.length)&&(categories=e.data)}catch(e){}const n=document.getElementById("searchInput");n&&(n.value=""),setupEventListeners(),initSlider(),updateLanguage()}async function loadData(){try{const e=new AbortController,t=setTimeout(()=>e.abort(),15e3),[a,n]=await Promise.all([fetch(`${API_BASE}/categories?restaurant=${isRestaurantMode()}`,{cache:"no-cache",signal:e.signal,headers:{Accept:"application/json","Content-Type":"application/json"}}),fetch(`${API_BASE}/dishes?restaurant=${isRestaurantMode()}&light=1`,{cache:"no-cache",signal:e.signal,headers:{Accept:"application/json","Content-Type":"application/json"}})]);if(clearTimeout(t),a.ok){const e=await a.json();categories=e.data||[]}else categories=[...sampleCategories];if(n.ok){const e=await n.json();dishes=(e.data||[]).map(e=>({...e,images:e.images||[],composition:e.composition||{ru:"",uz:"",en:""},weight:e.weight||"",cookingTime:e.cookingTime||""})),allDishes=[...dishes]}else dishes=[...sampleDishes],allDishes=[...sampleDishes];const o=localStorage.getItem("gavhar_cart");if(o&&(cart=JSON.parse(o)),renderCategories(),updateCartDisplay(),adaptiveImageLoading(),preloadCriticalImages(dishes),!currentCategory&&categories.length>0){const e=isAlcoholicAllowed(),t=categories.filter(t=>!t.isAlcoholic||e);if(t.length>0){const e=t[0],a=`${API_BASE}/categories?restaurant=${isRestaurantMode()}`,n=`${API_BASE}/dishes?restaurant=${isRestaurantMode()}&light=1&category=${encodeURIComponent(e.key)}`;try{fetch(n,{cache:"no-cache"}).catch(()=>{}),prewarmApiCache([a,n]);prewarmQueue(t.slice(1,6).map(e=>`${API_BASE}/dishes?restaurant=${isRestaurantMode()}&light=1&category=${encodeURIComponent(e.key)}`),1200,5)}catch(e){}selectMainCategory(e)}}else currentCategory&&renderDishes();dishes.forEach(e=>{updateQuantityDisplay(e.id)})}catch(e){loadDataFromLocalStorage()}}function loadDataFromLocalStorage(){const e=localStorage.getItem("gavhar_dishes"),t=localStorage.getItem("gavhar_cart"),a=localStorage.getItem("gavhar_categories");if(e?(dishes=JSON.parse(e),allDishes=[...dishes]):(dishes=[...sampleDishes],allDishes=[...sampleDishes],saveData()),t&&(cart=JSON.parse(t)),a?categories=JSON.parse(a):(categories=[...sampleCategories],localStorage.setItem("gavhar_categories",JSON.stringify(categories))),renderCategories(),updateCartDisplay(),!currentCategory&&categories.length>0){const e=isAlcoholicAllowed(),t=categories.filter(t=>!t.isAlcoholic||e);t.length>0&&selectMainCategory(t[0])}else currentCategory&&renderDishes();dishes.forEach(e=>{updateQuantityDisplay(e.id)})}function isRestaurantMode(){const e=new URLSearchParams(window.location.search);return e.has("restaurant")||e.has("admin")||e.has("service")}async function searchDishes(e){try{const t=await fetch(`${API_BASE}/dishes/search?q=${encodeURIComponent(e)}&restaurant=${isRestaurantMode()}`);if(t.ok){const a=await t.json();if(a&&a.success&&Array.isArray(a.data)){let t=a.data;if(0===t.length){const a=String(e).toLocaleLowerCase("ru-RU");t=allDishes.filter(e=>{const t=(e.name?.[currentLanguage]||"").toLocaleLowerCase("ru-RU"),n=(e.composition?.[currentLanguage]||"").toLocaleLowerCase("ru-RU");return t.includes(a)||n.includes(a)})}window.originalDishes||(window.originalDishes=[...dishes]),window.isGlobalSearch=!0,window.searchQuery=e,dishes=t,renderDishes()}else window.originalDishes||(window.originalDishes=[...dishes]),performGlobalSearch(e.toLocaleLowerCase("ru-RU"))}else window.originalDishes||(window.originalDishes=[...dishes]),performGlobalSearch(e.toLocaleLowerCase("ru-RU"))}catch(t){window.originalDishes||(window.originalDishes=[...dishes]),performGlobalSearch(e.toLocaleLowerCase("ru-RU"))}}function saveData(){localStorage.setItem("gavhar_dishes",JSON.stringify(dishes)),localStorage.setItem("gavhar_cart",JSON.stringify(cart))}function setupEventListeners(){document.getElementById("languageSelect").addEventListener("click",function(){const e=["RU","UZ","EN"],t=(e.indexOf(currentLanguage.toUpperCase())+1)%e.length;currentLanguage=e[t].toLowerCase(),this.textContent=e[t]+" ∨",updateLanguage(),renderCategories();const a=selectedCategory||categories.find(e=>e.key===currentCategory);a&&(updateSideTitle(a.name[currentLanguage]),a.subcategories&&a.subcategories.length>0&&(renderSubcategories(a.key),showSubcategoriesContainer())),renderDishes(),updateCartDisplay()});const e=document.getElementById("searchInput");if(e){const t=debounce(async e=>{e.length>2&&(void 0!==allDishes&&0!==allDishes.length||await loadData(),await searchDishes(e))},300);e.addEventListener("input",function(e){const a=e.target.value,n=document.getElementById("clearSearch");if(n&&(a.length>0?n.style.display="flex":n.style.display="none"),0===a.length)return window.isGlobalSearch=!1,window.searchQuery=null,window.originalDishes?(dishes=[...window.originalDishes],window.originalDishes=null):dishes=[...allDishes],void renderDishes();a.length<=2||t(a)})}const t=document.getElementById("clearSearch");t&&t.addEventListener("click",function(){const e=document.getElementById("searchInput");e&&(e.value="",t.style.display="none",window.isGlobalSearch=!1,window.searchQuery=null,window.originalDishes?(dishes=[...window.originalDishes],window.originalDishes=null):dishes=[...allDishes],renderDishes())}),document.getElementById("cartBtn").addEventListener("click",function(){toggleCartModal()}),document.getElementById("closeCart").addEventListener("click",function(){closeCartModal()}),document.getElementById("closeDishModal").addEventListener("click",function(){closeDishModal()});const a=document.querySelector(".checkout-btn");a&&a.addEventListener("click",function(){clearCart()}),document.addEventListener("click",function(e){e.target.classList.contains("cart-modal")&&closeCartModal(),e.target.classList.contains("dish-modal")&&closeDishModal()});const n=document.getElementById("dishesGrid");n&&n.addEventListener("click",function(e){const t=e.target.closest(".qty-btn");if(t){e.preventDefault(),e.stopPropagation();const a=parseInt(t.getAttribute("data-dish-id"),10);if(!isNaN(a)){changeQuantity(a,t.classList.contains("minus-btn")?-1:1),t.blur()}}});const o=document.getElementById("cartItems");o&&o.addEventListener("click",function(e){const t=e.target.closest(".cart-qty-btn");if(t){e.preventDefault(),e.stopPropagation();const a=parseInt(t.getAttribute("data-dish-id"),10);if(!isNaN(a)){changeQuantity(a,t.classList.contains("minus-btn")?-1:1),renderCartItems(),t.blur()}}});const i=document.querySelector(".logo img");i&&(i.onerror=function(){this.style.display="none"})}function enableHorizontalWheelScroll(e){try{if(!e||e.dataset&&"1"===e.dataset.wheelScrollAttached)return;if(!(window.matchMedia&&window.matchMedia("(pointer: fine)").matches))return;const t=function(t){const a=Math.abs(t.deltaX);if(Math.abs(t.deltaY)>a){t.preventDefault();const a=t.shiftKey?2:1;e.scrollLeft+=t.deltaY*a}};e.addEventListener("wheel",t,{passive:!1}),e.dataset.wheelScrollAttached="1"}catch(e){}}function clearCart(){0!==cart.length&&confirm("Вы уверены, что хотите очистить корзину?")&&(cart=[],saveData(),updateCartDisplay(),renderCartItems(),document.querySelectorAll('[id^="quantity-"]').forEach(e=>{e.textContent="0"}))}function updateLanguage(){document.querySelectorAll("[data-translate]").forEach(e=>{const t=e.dataset.translate;translations[currentLanguage]&&translations[currentLanguage][t]&&(e.textContent=translations[currentLanguage][t])}),document.getElementById("searchInput").placeholder=translations[currentLanguage].search_placeholder,renderCartItems()}function switchCategory(e){window.isGlobalSearch=!1,window.searchQuery=null,currentCategory=e,currentSubcategory=null,document.querySelectorAll(".tabs button").forEach(e=>{e.classList.remove("active")}),document.querySelector(`[data-category="${e}"]`).classList.add("active");const t=categories.find(t=>t.key===e);document.getElementById("sideTitle").textContent=t?t.name[currentLanguage]:e.toUpperCase();const a=document.getElementById("subcategoriesPanel");t&&t.subcategories&&t.subcategories.length>0?(renderSubcategories(e),a.classList.add("active")):a.classList.remove("active"),renderDishes()}function renderDishes(){const e=document.getElementById("dishesGrid");let t;if(window.isGlobalSearch)t=dishes.filter(e=>e.inStock&&(!e.isAlcoholic||isAlcoholicAllowed()));else{if(!currentCategory)return;t=dishes.filter(e=>e.category===currentCategory&&e.inStock&&(!e.isAlcoholic||isAlcoholicAllowed())),currentSubcategory&&(t=t.filter(e=>e.subcategory===currentSubcategory))}if(t.sort((e,t)=>(e.order||0)-(t.order||0)),e.innerHTML="",0===t.length){const t=window.isGlobalSearch?`По запросу "${window.searchQuery||""}" ничего не найдено`:"В этой категории нет доступных блюд";return void(e.innerHTML=`<div style="text-align: center; color: #f4e4bc; padding: 40px;">${t}</div>`)}const a=document.createElement("div");a.className="cards-row",e.appendChild(a);let n=0;const o=window.requestIdleCallback||function(e){return setTimeout(e,0)};!function e(){const i=document.createDocumentFragment(),s=Math.min(n+24,t.length);for(let e=n;e<s;e++){const a=createDishCard(t[e],e<6);i.appendChild(a)}if(a.appendChild(i),setupLazyImages(a),Array.isArray(cart)&&cart.length>0)for(let e=n;e<s;e++)updateQuantityDisplay(t[e].id);n=s,n<t.length&&o(e)}()}function createDishCard(e,t=!1){const a=document.createElement("div");a.className="card";const n=e.isAlcoholic?'<div class="alcoholic-overlay">18+</div>':"",o=(e.image&&""!==String(e.image).trim()?e.image:Array.isArray(e.images)&&e.images[0]?e.images[0]:null)||"/ELEMENTS/image 2.png",i="string"==typeof o&&o.includes("images.unsplash.com"),s="string"==typeof o&&!/^https?:\/\//i.test(o),r=getImageCacheBuster(),c=getOptimalImageQuality(),l=getSupportedImageFormats(),d=(e=>{if(i){const t=l.avif?"avif":l.webp?"webp":"auto",a=c.quality;return{placeholder:`${e}${e.includes("?")?"&":"?"}w=20&h=12&fit=crop&fm=webp&blur=10&q=20&_v=${r}`,small:`${e}${e.includes("?")?"&":"?"}w=300&h=200&fit=crop&fm=${t}&auto=format&q=${Math.max(a-10,50)}&_v=${r}`,medium:`${e}${e.includes("?")?"&":"?"}w=400&h=250&fit=crop&fm=${t}&auto=format&q=${a}&_v=${r}`,large:`${e}${e.includes("?")?"&":"?"}w=600&h=400&fit=crop&fm=${t}&auto=format&q=${Math.min(a+5,90)}&_v=${r}`,webp:`${e}${e.includes("?")?"&":"?"}w=400&h=250&fit=crop&fm=webp&auto=format&q=${a}&_v=${r}`,jpeg:`${e}${e.includes("?")?"&":"?"}w=400&h=250&fit=crop&fm=jpg&auto=format&q=${a}&_v=${r}`,original:`${e}${e.includes("?")?"&":"?"}auto=format&q=${Math.min(a+10,95)}&_v=${r}`}}return{placeholder:e,small:e,medium:e,large:e,webp:e,jpeg:e,original:e}})(o);let u="";if(s){u=o.startsWith("/")?o:`/${o}`;const e=u.lastIndexOf("/"),t=(u.substring(0,e),u.substring(e+1)),a=t.lastIndexOf("."),n=(a>-1&&t.substring(0,a),u.split("?")[0]);u=n.replace(/-(100|200|400)\.(webp|avif)$/i,"-800.webp")}i&&d.placeholder;const g=t?"eager":"lazy",h=t?"high":"auto";t&&d.medium,t||d.medium;a.innerHTML=`\n         <div class="card-image-container">\n            ${i?`\n            <picture>\n                ${l.avif?`<source srcset="${d.small.replace("webp","avif")} 300w, ${d.medium.replace("webp","avif")} 400w, ${d.large.replace("webp","avif")} 600w" type="image/avif" sizes="(max-width: 480px) 300px, (max-width: 768px) 400px, (max-width: 1200px) 300px, 400px">`:""}\n                ${l.webp?`<source srcset="${d.small} 300w, ${d.medium} 400w, ${d.large} 600w" type="image/webp" sizes="(max-width: 480px) 300px, (max-width: 768px) 400px, (max-width: 1200px) 300px, 400px">`:""}\n                <source srcset="${d.small.replace(l.avif?"avif":"webp","jpg")} 300w, ${d.jpeg} 400w, ${d.large.replace(l.avif?"avif":"webp","jpg")} 600w" type="image/jpeg" sizes="(max-width: 480px) 300px, (max-width: 768px) 400px, (max-width: 1200px) 300px, 400px">\n                <img\n                    ${t?`src="${d.medium}"`:`data-src="${d.medium}"`}\n                    alt="${e.name[currentLanguage]}"\n                    loading="${g}"\n                    decoding="async"\n                    fetchpriority="${h}"\n                    width="400"\n                    height="250"\n                    style="transition: all 0.3s ease; filter: brightness(1.05); opacity: 1;"\n                >\n            </picture>`:s?`\n            <img\n                ${t?`src="${(u||o)+((u||o).includes("?")?"&":"?")+"v="+r}"`:`data-src="${(u||o)+((u||o).includes("?")?"&":"?")+"v="+r}"`}\n                alt="${e.name[currentLanguage]}"\n                loading="${g}"\n                decoding="async"\n                fetchpriority="${h}"\n                width="400"\n                height="250"\n                style="image-rendering:auto; transition: opacity 0.3s; filter: brightness(1.05); opacity: 1;"\n            >`:`\n            <img\n                ${t?`src="${o}${o.includes("?")?"&":"?"}v=${r}"`:`data-src="${o}${o.includes("?")?"&":"?"}v=${r}"`}\n                alt="${e.name[currentLanguage]}"\n                loading="${g}"\n                decoding="async"\n                fetchpriority="${h}"\n                width="400"\n                height="250"\n                style="transition: opacity 0.3s; filter: brightness(1.05); opacity: 1;"\n            >`}\n            ${n}\n         </div>\n         <div class="card-body">\n            <p>${e.name[currentLanguage]}</p>\n            <div class="price">${e.price.toLocaleString()} сум</div>\n            <div class="qty">\n                <button class="qty-btn minus-btn" data-dish-id="${e.id}">-</button>\n                <span id="quantity-${e.id}">0</span>\n                <button class="qty-btn plus-btn" data-dish-id="${e.id}">+</button>\n            </div>\n         </div>\n     `;const m=a.querySelector(".card-image-container");return m&&m.addEventListener("click",function(t){t.stopPropagation(),openDishModal(e)}),a}function changeQuantity(e,t){const a=dishes.find(t=>t.id===e);if(!a)return;const n=cart.find(t=>t.dishId===e);n?(n.quantity+=t,n.quantity<=0&&(cart=cart.filter(t=>t.dishId!==e))):t>0&&cart.push({dishId:e,quantity:1,dish:a}),saveData(),updateCartDisplay(),updateQuantityDisplay(e)}function updateQuantityDisplay(e){const t=cart.find(t=>t.dishId===e),a=document.getElementById(`quantity-${e}`);a&&(a.textContent=t?t.quantity:0)}function updateCartDisplay(){const e=document.getElementById("cartCount"),t=cart.reduce((e,t)=>e+t.quantity,0);e.textContent=t;document.querySelectorAll('[id^="quantity-"]').forEach(e=>{const t=e.id.replace("quantity-",""),a=parseInt(t,10);isNaN(a)||updateQuantityDisplay(a)})}function toggleCartModal(){const e=document.getElementById("cartModal");e.classList.toggle("active"),e.classList.contains("active")&&renderCartItems()}function closeCartModal(){document.getElementById("cartModal").classList.remove("active")}function renderCartItems(){const e=document.getElementById("cartItems"),t=document.getElementById("cartTotal");if(0===cart.length){e.innerHTML=`<p style="text-align: center; color: #f4e4bc;">${translations[currentLanguage].cart_empty}</p>`,t.textContent=`0 ${translations[currentLanguage].sum}`;const a=document.querySelector(".cart-footer").querySelector(".cart-breakdown");return void(a&&a.remove())}e.innerHTML="";let a=0;cart.forEach(t=>{const n=document.createElement("div");n.className="cart-item";const o=t.dish.price*t.quantity;a+=o,n.innerHTML=`\n            <div class="cart-item-info">\n                <div class="cart-item-name">${t.dish.name[currentLanguage]}</div>\n                <div class="cart-item-price">${t.dish.price.toLocaleString()} ${translations[currentLanguage].sum} × ${t.quantity}</div>\n            </div>\n            <div class="cart-item-quantity">\n                <button class="cart-qty-btn minus-btn" data-dish-id="${t.dishId}">-</button>\n                <span>${t.quantity}</span>\n                <button class="cart-qty-btn plus-btn" data-dish-id="${t.dishId}">+</button>\n            </div>\n        `,e.appendChild(n)});const n=getServiceChargePercent(),o=Math.round(a*n/100),i=a+o,s=document.querySelector(".cart-footer"),r=s.querySelector(".cart-breakdown");if(r&&r.remove(),n>0){const e=document.createElement("div");e.className="cart-breakdown",e.innerHTML=`\n            <div class="cart-subtotal">\n                <span>${translations[currentLanguage].order_total}</span>\n                <span>${a.toLocaleString()} ${translations[currentLanguage].sum}</span>\n            </div>\n            <div class="cart-service">\n                <span>${translations[currentLanguage].service_charge} (${n}%):</span>\n                <span>${o.toLocaleString()} ${translations[currentLanguage].sum}</span>\n            </div>\n        `,s.insertBefore(e,s.querySelector(".cart-total"))}t.textContent=`${i.toLocaleString()} ${translations[currentLanguage].sum}`}function getServiceChargePercent(){const e=new URLSearchParams(window.location.search);if(e.has("restaurant")||e.has("service")){if(e.has("service")){const t=e.get("service"),a=parseInt(t);if(!isNaN(a)&&a>=0&&a<=30)return a}return parseInt(localStorage.getItem("gavhar_service_charge")||"10")}return 0}async function openDishModal(e){const t=document.getElementById("dishModal"),a=document.getElementById("dishModalImage"),n=document.getElementById("dishModalName"),o=document.getElementById("dishModalComposition"),i=document.getElementById("dishModalWeight"),s=document.getElementById("dishModalTime"),r=document.getElementById("dishModalPrice"),c=document.getElementById("modalQuantity");if(a&&(a.setAttribute("decoding","async"),a.setAttribute("loading","eager"),a.setAttribute("fetchpriority","high")),e.__light)try{const t=await fetch(`${API_BASE}/dishes/${e.id}`,{cache:"no-cache"});if(t.ok){const a=await t.json();a&&a.success&&a.data&&(e=a.data)}}catch(e){}let l=[];e.image&&l.push(e.image),e.images&&Array.isArray(e.images)&&e.images.forEach(e=>{e&&""!==e.trim()&&!l.includes(e)&&l.push(e)}),0===l.length&&(l=[e.image||"/ELEMENTS/image 2.png"]),window.currentDishImages=l,window.currentImageIndex=0,a.src=window.currentDishImages[0],n.textContent=e.name[currentLanguage],o.textContent=e.composition[currentLanguage],i.textContent=e.weight,s.textContent=e.cookingTime,r.textContent=`${e.price.toLocaleString()} сум`;const d=cart.find(t=>t.dishId===e.id);c.textContent=d?d.quantity:0;const u=document.querySelector(".gallery-prev"),g=document.querySelector(".gallery-next"),h=document.querySelector(".gallery-nav");window.currentDishImages.length<=1?h&&(h.style.display="none"):(h&&(h.style.display="flex"),u&&(u.style.display="flex"),g&&(g.style.display="flex"));let m=document.querySelector(".image-counter");m||(m=document.createElement("div"),m.className="image-counter",m.style.cssText="\n            position: absolute;\n            bottom: 10px;\n            right: 10px;\n            background: rgba(0,0,0,0.7);\n            color: white;\n            padding: 5px 10px;\n            border-radius: 15px;\n            font-size: 12px;\n        ",document.querySelector(".dish-gallery").appendChild(m)),window.currentDishImages.length>1?(m.textContent=`${window.currentImageIndex+1} / ${window.currentDishImages.length}`,m.style.display="block"):m.style.display="none",u&&(u.onclick=()=>{window.currentImageIndex>0?window.currentImageIndex--:window.currentImageIndex=window.currentDishImages.length-1,a.src=window.currentDishImages[window.currentImageIndex];const e=document.querySelector(".image-counter");e&&(e.textContent=`${window.currentImageIndex+1} / ${window.currentDishImages.length}`)}),g&&(g.onclick=()=>{window.currentImageIndex<window.currentDishImages.length-1?window.currentImageIndex++:window.currentImageIndex=0,a.src=window.currentDishImages[window.currentImageIndex];const e=document.querySelector(".image-counter");e&&(e.textContent=`${window.currentImageIndex+1} / ${window.currentDishImages.length}`)}),document.getElementById("modalQuantityMinus").onclick=()=>{changeQuantity(e.id,-1);const t=cart.find(t=>t.dishId===e.id);c.textContent=t?t.quantity:0},document.getElementById("modalQuantityPlus").onclick=()=>{changeQuantity(e.id,1);const t=cart.find(t=>t.dishId===e.id);c.textContent=t?t.quantity:0},t.classList.add("active")}function closeDishModal(){document.getElementById("dishModal").classList.remove("active")}function performGlobalSearch(e){0===allDishes.length&&(allDishes=[...dishes],0===allDishes.length&&(allDishes=[...sampleDishes])),window.isGlobalSearch=!0,window.searchQuery=e;const t=String(e).toLocaleLowerCase("ru-RU"),a=allDishes.filter(e=>{const a=(e.name?.[currentLanguage]||"").toLocaleLowerCase("ru-RU"),n=(e.composition?.[currentLanguage]||"").toLocaleLowerCase("ru-RU");return a.includes(t)||n.includes(t)});dishes=a,renderDishes()}function filterDishes(e){document.querySelectorAll(".card").forEach(t=>{t.querySelector("p").textContent.toLocaleLowerCase("ru-RU").includes(e)?t.style.display="block":t.style.display="none"})}function isAlcoholicAllowed(){const e=new URLSearchParams(window.location.search);return e.has("restaurant")||e.has("admin")}function renderCategories(){const e=document.getElementById("mainCategories");e.innerHTML="";const t=isAlcoholicAllowed();categories.filter(e=>!e.isAlcoholic||t).forEach((t,a)=>{const n=document.createElement("button");n.className="main-category",n.setAttribute("data-category",t.key),n.textContent=t.name[currentLanguage],t.key===currentCategory&&n.classList.add("active"),selectedCategory&&t.key===selectedCategory.key&&n.classList.add("selected"),n.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();const t=e.currentTarget.getAttribute("data-category"),a=categories.find(e=>e.key===t);a&&selectMainCategory(a)}),e.appendChild(n)}),enableHorizontalWheelScroll(e)}function selectMainCategory(e){void 0!==allDishes&&0!==allDishes.length?selectMainCategoryInternal(e):loadData().then(()=>{selectMainCategoryInternal(e)})}function selectMainCategoryInternal(e){window.isGlobalSearch=!1,window.searchQuery=null,selectedCategory=e,currentCategory=e.key,currentSubcategory=null,updateSideTitle(e.name[currentLanguage]),e.subcategories&&e.subcategories.length>0?(renderSubcategories(e.key),showSubcategoriesContainer()):hideSubcategoriesContainer(),renderDishes(),renderCategories()}function renderSubcategories(e){const t=categories.find(t=>t.key===e);if(!t||!t.subcategories)return;let a=document.querySelector(".subcategories-container");if(!a){a=document.createElement("div"),a.className="subcategories-container";const e=document.createElement("div");e.className="subcategories-scroll",a.appendChild(e);const t=document.getElementById("mainCategories");t.parentNode.insertBefore(a,t.nextSibling)}const n=a.querySelector(".subcategories-scroll");n.innerHTML="";const o=document.createElement("div");o.className="subcategory-item",o.textContent=translations[currentLanguage].all,currentSubcategory||o.classList.add("active"),o.addEventListener("click",()=>selectSubcategory(null)),n.appendChild(o),t.subcategories.forEach(e=>{const t=document.createElement("div");t.className="subcategory-item",t.textContent=e.name[currentLanguage],t.setAttribute("data-subcategory",e.key),currentSubcategory===e.key&&t.classList.add("active"),t.addEventListener("click",()=>selectSubcategory(e.key)),n.appendChild(t)})}function showSubcategoriesContainer(){const e=document.querySelector(".subcategories-container");e&&e.classList.add("show")}function hideSubcategoriesContainer(){const e=document.querySelector(".subcategories-container");e&&e.classList.remove("show")}function selectSubcategory(e){if(currentSubcategory=e,document.querySelectorAll(".subcategory-item").forEach(e=>{e.classList.remove("active")}),e){const t=document.querySelector(`[data-subcategory="${e}"]`);t&&t.classList.add("active")}else{const e=document.querySelector(".subcategory-item:first-child");e&&e.classList.add("active")}renderDishes()}function updateSideTitle(e){const t=document.getElementById("sideTitle");t&&(t.textContent=e.toUpperCase())}function clearSelectedCategory(){selectedCategory=null,currentSubcategory=null,hideSubcategoriesContainer();const e=isAlcoholicAllowed(),t=categories.filter(t=>!t.isAlcoholic||e);t.length>0&&selectMainCategory(t[0])}function closeSubcategories(){document.getElementById("subcategoriesPanel").classList.remove("active")}function initSlider(){}function slideLeft(){const e=document.getElementById("dishesGrid"),t=e.querySelectorAll(".card"),a=t[0]?t[0].offsetWidth+30:390;currentSlide>0&&(currentSlide--,e.scrollTo({left:currentSlide*a,behavior:"smooth"}))}function slideRight(){const e=document.getElementById("dishesGrid"),t=e.querySelectorAll(".card"),a=t[0]?t[0].offsetWidth+30:390,n=Math.max(0,t.length-4);currentSlide<n&&(currentSlide++,e.scrollTo({left:currentSlide*a,behavior:"smooth"}))}document.addEventListener("DOMContentLoaded",function(){initializeApp(),document.addEventListener("click",function(e){("BUTTON"===e.target.tagName||e.target.closest("button"))&&setTimeout(()=>{document.activeElement.blur()},0)}),document.addEventListener("mousedown",function(e){("BUTTON"===e.target.tagName||e.target.closest("button"))&&e.target.blur()}),document.addEventListener("touchstart",function(e){("BUTTON"===e.target.tagName||e.target.closest("button"))&&(e.target.blur(),e.target.style.outline="none",e.target.style.webkitTapHighlightColor="transparent")}),document.addEventListener("touchend",function(e){("BUTTON"===e.target.tagName||e.target.closest("button"))&&setTimeout(()=>{e.target.blur(),e.target.style.outline="none",e.target.style.webkitTapHighlightColor="transparent"},0)}),document.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||("BUTTON"===e.target.tagName||e.target.closest("button"))&&(e.preventDefault(),e.target.click(),e.target.blur())})}),document.addEventListener("visibilitychange",function(){if(!document.hidden){const e=localStorage.getItem("gavhar_data_updated"),t=localStorage.getItem("gavhar_last_known_update");e&&e!==t?(localStorage.setItem("gavhar_last_known_update",e),loadData().then(()=>{})):void 0!==allDishes&&0!==allDishes.length||loadData().then(()=>{})}}),window.addEventListener("focus",function(){const e=localStorage.getItem("gavhar_data_updated"),t=localStorage.getItem("gavhar_last_known_update");e&&e!==t?(localStorage.setItem("gavhar_last_known_update",e),loadData().then(()=>{})):void 0!==allDishes&&0!==allDishes.length||loadData().then(()=>{})}),window.addEventListener("storage",function(e){"gavhar_data_updated"===e.key&&loadData().then(()=>{})}),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").catch(()=>{})}),window.changeQuantity=changeQuantity,window.closeSubcategories=closeSubcategories,window.clearSelectedCategory=clearSelectedCategory;